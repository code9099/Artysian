# CraftStory - AI-Powered Cultural Heritage Platform

CraftStory is a full-stack application that connects artisans with cutting-edge AI technology to preserve, document, and share traditional crafts with the world. Built with Next.js 15, TypeScript, Tailwind CSS, and Firebase.

## 🚀 Features

- **Real-time Voice Processing**: Google Cloud Speech-to-Text with multi-language support (English, Hindi, Tamil)
- **AI-Powered Q&A Onboarding**: Dynamic questions generated by Gemini based on artisan responses
- **Text-to-Speech Integration**: Questions spoken back in artisan's selected language
- **Real-time Firestore Updates**: Profile data saved incrementally during onboarding
- **Cultural Sensitivity**: AI prompts designed for cultural heritage preservation
- **Tinder-style Discovery**: Swipe through crafts from artisans worldwide
- **Artisan Dashboard**: Manage crafts, view analytics, and generate content
- **Multi-language Support**: Full support for English, Hindi, and Tamil with proper scripts

## 🛠️ Tech Stack

- **Frontend**: Next.js 15 (App Router), TypeScript, Tailwind CSS, Framer Motion
- **UI Components**: shadcn/ui, Radix UI
- **Backend**: Firebase (Firestore, Auth, Storage, Functions)
- **AI Integration**: Google Cloud (Speech-to-Text, Gemini, Vertex AI)
- **Styling**: Custom color palette with Poppins & Literata fonts

## 📦 Installation

1. **Clone the repository**
   ```bash
   git clone <repository-url>
   cd craftstory
   ```

2. **Install dependencies**
   ```bash
   npm install
   ```

3. **Set up environment variables**
   ```bash
   cp .env.example .env.local
   ```
   
   Fill in your Firebase and Google Cloud credentials in `.env.local`:
   ```env
   # Firebase Configuration
   NEXT_PUBLIC_FIREBASE_API_KEY=your_firebase_api_key
   NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=your_project_id.firebaseapp.com
   NEXT_PUBLIC_FIREBASE_PROJECT_ID=your_project_id
   NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=your_project_id.appspot.com
   NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=your_messaging_sender_id
   NEXT_PUBLIC_FIREBASE_APP_ID=your_app_id
   NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID=your_measurement_id

   # Firebase Admin SDK
   FIREBASE_PROJECT_ID=your_project_id
   FIREBASE_CLIENT_EMAIL=your_service_account_email
   FIREBASE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nYOUR_PRIVATE_KEY\n-----END PRIVATE KEY-----\n"
   FIREBASE_STORAGE_BUCKET=your_project_id.appspot.com

   # Google Cloud AI APIs
   NEXT_PUBLIC_GOOGLE_API_KEY=your_google_api_key
   GOOGLE_CLOUD_PROJECT_ID=your_project_id
   GOOGLE_APPLICATION_CREDENTIALS=path/to/service-account.json
   VERTEX_AI_LOCATION=us-central1
   ```

4. **Run the development server**
   ```bash
   npm run dev
   ```

5. **Open your browser**
   Navigate to [http://localhost:3000](http://localhost:3000)

## 🔧 Firebase Setup

### 1. Create a Firebase Project
1. Go to [Firebase Console](https://console.firebase.google.com/)
2. Create a new project
3. Enable Authentication, Firestore, and Storage
4. Generate a service account key

### 2. Deploy Firestore Rules
```bash
firebase deploy --only firestore:rules
```

### 3. Deploy Firebase Functions
```bash
cd functions
npm install
firebase deploy --only functions
```

## 🤖 AI Integration Setup

### Google Cloud Speech-to-Text
1. Enable the Speech-to-Text API in Google Cloud Console
2. Create a service account with Speech-to-Text permissions
3. Download the JSON key file
4. Set `GOOGLE_APPLICATION_CREDENTIALS` environment variable

### Google Cloud Text-to-Speech
1. Enable the Text-to-Speech API in Google Cloud Console
2. The same service account can be used for both Speech-to-Text and TTS
3. Supports multiple languages: English (en-US), Hindi (hi-IN), Tamil (ta-IN)

### Google Gemini API
1. Enable the Generative AI API
2. Get your API key from the Google AI Studio
3. Set `NEXT_PUBLIC_GOOGLE_API_KEY` environment variable
4. Used for dynamic question generation and profile processing

### Vertex AI (Image Generation)
1. Enable the Vertex AI API
2. Set up authentication with your service account
3. Set `VERTEX_AI_LOCATION` environment variable

### Language Support
The application supports three languages with proper cultural context:
- **English (en)**: Default language with standard prompts
- **Hindi (hi)**: Devanagari script with cultural sensitivity
- **Tamil (ta)**: Tamil script with regional context

## 📁 Project Structure

```
craftstory/
├── src/
│   ├── app/                    # Next.js App Router pages
│   │   ├── artisan/           # Artisan-specific pages
│   │   ├── explore/           # Craft discovery page
│   │   └── role-select/       # Role selection page
│   ├── components/            # React components
│   │   ├── ui/               # shadcn/ui components
│   │   ├── Header.tsx        # Navigation header
│   │   ├── Footer.tsx        # Site footer
│   │   ├── VoiceOnboard.tsx  # Voice recording component
│   │   ├── UploadCamera.tsx  # Image upload component
│   │   ├── SwipeCardDeck.tsx # Tinder-style card deck
│   │   └── ProductPin.tsx    # Craft card component
│   ├── lib/                  # Utilities and configurations
│   │   ├── types.ts          # TypeScript type definitions
│   │   ├── firebaseClient.ts # Firebase client config
│   │   └── firebaseAdmin.ts  # Firebase admin config
│   └── ai/                   # AI flow implementations
│       └── flows/            # AI processing functions
├── functions/                 # Firebase Functions
│   ├── src/                  # Function source code
│   └── package.json          # Functions dependencies
├── firestore.rules           # Firestore security rules
└── firestore-schema.md       # Database schema documentation
```

## 🎨 Customization

### Color Palette
The app uses a custom color palette defined in `src/app/globals.css`:
- **Cream**: #FAF9F6
- **Beige**: #FFF4E6
- **Charcoal**: #2B2B2B
- **Brown**: #5A4634
- **Gold**: #C9A227
- **Gold Light**: #FFD369

### Fonts
- **Poppins**: Used for headings and UI elements
- **Literata**: Used for serif text and decorative elements

## 🧪 Testing the Artisan Onboarding Flow

1. **Start the development server**
```bash
npm run dev
   ```

2. **Navigate to the role selection**
   - Go to [http://localhost:3000/role-select](http://localhost:3000/role-select)
   - Click "I'm an Artisan"

3. **Complete the onboarding process**
   - **Step 1**: Record your voice or use the mock transcript
   - **Step 2**: Upload images of your crafts
   - **Step 3**: Review and complete your profile

4. **Access the dashboard**
   - After completion, you'll be redirected to `/artisan/dashboard`
   - Explore the different sections: Studio, Profile, Social Toolkit, Insights

## 🚀 NEXT STEPS - Enabling Real AI Integration

### 1. Speech-to-Text Integration
Replace the mock implementation in `functions/src/onboardVoice.ts`:

```typescript
// Replace this mock code:
const mockTranscript = mockTranscripts[Math.floor(Math.random() * mockTranscripts.length)];

// With real Google Cloud Speech-to-Text:
const speechClient = new SpeechClient();
const request = {
  audio: { content: audioBuffer },
  config: {
    encoding: 'WEBM_OPUS',
    sampleRateHertz: 48000,
    languageCode: language,
  },
};
const [response] = await speechClient.recognize(request);
const transcript = response.results
  .map(result => result.alternatives?.[0]?.transcript)
  .join(' ');
```

### 2. Gemini Integration
Replace the mock implementation in `functions/src/generateCraft.ts`:

```typescript
// Replace mock with real Gemini API:
const genAI = new GoogleGenerativeAI(process.env.GOOGLE_API_KEY!);
const model = genAI.getGenerativeModel({ model: "gemini-pro" });
const result = await model.generateContent(prompt);
const response = await result.response;
const generatedContent = response.text();
```

### 3. Vertex AI Image Generation
Replace the mock implementation in `functions/src/visualizeStory.ts`:

```typescript
// Replace mock with real Vertex AI:
const vertexAI = new VertexAI({
  project: process.env.GOOGLE_CLOUD_PROJECT_ID,
  location: process.env.VERTEX_AI_LOCATION,
});
const model = 'imagegeneration@006';
const generativeModel = vertexAI.getGenerativeModel({ model });
const result = await generativeModel.generateContent([prompt]);
```

## 📊 Database Schema

See `firestore-schema.md` for detailed information about the Firestore collections and their structure.

## 🔒 Security

- All API endpoints are protected with Firebase Authentication
- Firestore rules ensure users can only access their own data
- Input validation and sanitization on all user inputs
- Rate limiting on AI processing endpoints

## 🚀 Deployment

### Vercel (Recommended)
1. Connect your GitHub repository to Vercel
2. Set environment variables in Vercel dashboard
3. Deploy automatically on push to main branch

### Firebase Hosting
```bash
npm run build
firebase deploy --only hosting
```

## 🤝 Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Add tests if applicable
5. Submit a pull request

## 📄 License

This project is licensed under the MIT License - see the LICENSE file for details.

## 🆘 Support

For support, email hello@craftstory.com or create an issue in the GitHub repository.

---

**Made with ❤️ for cultural preservation**